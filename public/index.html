<!DOCTYPE html>
<html lang="en" dir="ltr" ng-app="MyApp">
    <head>
        <meta charset="utf-8">
        <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.7.8/angular.min.js" charset="utf-8"></script>
		<script src="app.js" charset="utf-8"></script>
        <link rel="stylesheet" href="main.css">
		<title>Trusty Townies</title>
    </head>
    <body>
		<div ng-controller="AuthController as auth">
			<nav>
	            <!-- LOGIN -->
	            <h3 ng-click="login={'display':'block'}">LOGIN</h3>
	            <!-- login modal -->
				<div ng-hide="auth.loggedInUsername">
					<div id="loginModal" class="modal" ng-style="login">
		                <form ng-submit="auth.logIn()">
		                    <input type="text" ng-model="auth.username" placeholder="username">
		                    <input type="password" ng-model="auth.password" placeholder="password">
		                    <input type="submit" value="Log In">
		                </form>
		                <button ng-click="login={}">X</button>
		            </div>
				</div>
	            <!-- LOGOUT -->
				<div ng-show="auth.loggedInUsername">
					<form ng-submit="auth.logOut()">
		                <input type="submit" value="Log Out">
		            </form>
				</div>
	            <!-- CREATE USER -->
				<div ng-hide="auth.loggedInUsername">
					<form ng-submit="auth.createUser()">
		                <input type="text" ng-model="auth.username" placeholder="username">
		                <input type="text" ng-model="auth.password" placeholder="password">
		                <!-- <input type="text" ng-model="auth.confirmPassword" placeholder="confirm password"> -->
		                <input type="submit" value="Create User"/>
		            </form>
				</div>
	        </nav>

			<h1>Trusty Townies</h1>
	    	<div ng-if="auth.loggedInUsername">
	  			<form ng-submit="auth.createTownie()">
	  				<input type="text" ng-model="auth.name" placeholder="Company Name"/>
					<input type="text" ng-model="auth.city" placeholder="City"/>
					<input type="text" ng-model="auth.state" placeholder="State"/>
					<input type="text" ng-model="auth.description" placeholder="description"/>
					<input type="submit" value="Create New Townie"/>
	  			</form>
				<div>
				    Search Company Name:<input ng-model="searchBox.name" type="text" placeholder="Enter a Name">
				    Search By City:<input ng-model="searchBox.city" type="text" placeholder="Enter a City">
				    Search By State:<input ng-model="searchBox.state" type="text" placeholder="Enter a State"><br /><br />
				    <table>
				        <tr><th>Company Name</th><th>City</th><th>State</th><th>Description</th></tr>
				        <tr ng-repeat="companies in auth.companies | filter : searchBox">
				            <td>{{companies.name}}</td>
				            <td>{{companies.city}}</td>
				            <td>{{companies.state}}</td>
				            <td>{{companies.description}}</td>
				        </tr>
				    </table>
				</div>
			</div>
		</div>

		<div id="map-search-panel">
			<b>Start:</b>
			<input type="text" id="start">
			<b>End:</b>
			<input type="text" id="end">
			<button id="directions-btn" type="button" name="button">Get Directions</button>
		</div>
		<div id="map"></div>

	<script>
		function initMap() {
			const directionsService = new google.maps.DirectionsService();
			const directionsRenderer = new google.maps.DirectionsRenderer();
			const map = new google.maps.Map(document.getElementById('map'), {
				zoom: 7,
				center: {lat: 41.85, lng: -87.65}
			});
			directionsRenderer.setMap(map);

			const onChangeHandler = function() {
				calculateAndDisplayRoute(directionsService, directionsRenderer);
			};
			document.getElementById('directions-btn').addEventListener('click', onChangeHandler);
			}
		function calculateAndDisplayRoute(directionsService, directionsRenderer) {
			directionsService.route(
				{
					origin: {query: document.getElementById('start').value},
					destination: {query: document.getElementById('end').value},
					travelMode: 'DRIVING'
				},
				function(response, status) {
					if (status === 'OK') {
						directionsRenderer.setDirections(response);
					} else {
						window.alert('Directions request failed due to ' + status);
					}
				});
		}
	</script>
	<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyD-99aWDom_qs9Pfq5tS3ay3nBIa4kHyew&callback=initMap" async defer>
	</script>
		  </body>
</html>

<!-- <div id="floating-panel">
	<b>Start: </b>
	<select id="start">
		<option value="chicago, il">Chicago</option>
		<option value="st louis, mo">St Louis</option>
		<option value="joplin, mo">Joplin, MO</option>
		<option value="oklahoma city, ok">Oklahoma City</option>
		<option value="amarillo, tx">Amarillo</option>
		<option value="gallup, nm">Gallup, NM</option>
		<option value="flagstaff, az">Flagstaff, AZ</option>
		<option value="winona, az">Winona</option>
		<option value="kingman, az">Kingman</option>
		<option value="barstow, ca">Barstow</option>
		<option value="san bernardino, ca">San Bernardino</option>
		<option value="los angeles, ca">Los Angeles</option>
	</select>
	<b>End: </b>
	<select id="end">
		<option value="chicago, il">Chicago</option>
		<option value="st louis, mo">St Louis</option>
		<option value="joplin, mo">Joplin, MO</option>
		<option value="oklahoma city, ok">Oklahoma City</option>
		<option value="amarillo, tx">Amarillo</option>
		<option value="gallup, nm">Gallup, NM</option>
		<option value="flagstaff, az">Flagstaff, AZ</option>
		<option value="winona, az">Winona</option>
		<option value="kingman, az">Kingman</option>
		<option value="barstow, ca">Barstow</option>
		<option value="san bernardino, ca">San Bernardino</option>
		<option value="los angeles, ca">Los Angeles</option>
	</select>
</div> -->
